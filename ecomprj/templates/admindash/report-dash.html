{% extends 'admindash/base-dash.html' %}
{% load static %}
{% block content %}       
{% load humanize %}
<main>
    
    <!-- END OF INSIGHTS -->




    <div class="insights">
        <div class="sales" style="width:800px;height:500px">
            <span class="material-icons-sharp">analytics</span>
            <!--Write the code here-->
            <canvas id="lineChart" width="800" height="400"></canvas>
        </div>
        <script>
            var ctx = document.getElementById('lineChart').getContext('2d');
        
            var data = {
                labels: [{% for month_data in all_months_data %}"{{ month_data.month }}/{{ month_data.year }}", {% endfor %}],
                datasets: [{
                    label: 'Task Completion Ratio (%)',
                    data: [{% for month_data in all_months_data %}{{ month_data.completion_ratio }}, {% endfor %}],
                    borderColor: 'blue',
                    backgroundColor: 'rgba(0, 0, 255, 0.2)',
                    fill: true
                }]
            };
        
            var options = {
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Completion Ratio (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Month'
                        }
                    }
                }
            };
        
            var lineChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: options
            });
        </script>
        <!--END OF SALES-->
        <div class="expenses">
            <span class="material-icons-sharp">bar_chart</span>
            <div class="middle">
                <div class="left">
                    <h3>Task Creation vs Completion</h3>
                    <h1>{{task_starts_thismonth.count}} : {{task_done_thismonth.count}}</h1>
                </div>
                <div class="progress">
                    <svg>
                        {% comment %} <circle cx='38' cy='38' r='36'></circle> {% endcomment %}
                    </svg>
                    <div class="number">
                        <h1>{{completion_ratio_thismonth}}%</h1> 
                        
                    </div>
                </div>
            </div>
            <small class="text-muted">Last 30 days</small>
        </div>
        <!--END OF EXPENSES-->
        <div class="income">
            <span class="material-icons-sharp">stacked_line_chart</span>
            <div class="middle">
                <div class="left">
                    <h3>Task Completed in this Month</h3>
                    <h1>{{task_done_thismonth.count}}</h1>
                </div>
                {% comment %} <div class="progress">
                    <svg>
                        <circle cx='38' cy='38' r='36'></circle>
                    </svg>
                    <div class="number">
                        <p>44%</p>
                    </div>
                </div> {% endcomment %}
            </div>
            <small class="text-muted">Last 30 days</small>
        </div>
        <!--END OF INCOME-->
    </div>

    <canvas id="donutChart" width="100" height="100"></canvas>
    

<script>
    var ctx = document.getElementById('donutChart').getContext('2d');

    var data = {
        labels: [
            "Pending",
            "Processing",
            "Production Starts",
            "Drafting",
            "Cutting",
            "Assembly",
            "Seaming",
            "Padding",
            "Detailing",
            "Quality Control",
            "To Be Picked Up",
            "Done"
        ],
        datasets: [{
            data: [
                {{ task_pending.count }},
                {{ task_processing.count }},
                {{ task_starts.count }},
                {{ task_drafting.count }},
                {{ task_cutting.count }},
                {{ task_assembly.count }},
                {{ task_seaming.count }},
                {{ task_padding.count }},
                {{ task_detailing.count }},
                {{ task_quality_control.count }},
                {{ task_pickup.count }},
                {{ task_done.count }}
            ],
            backgroundColor: [
                "#FF6384",
                "#36A2EB",
                "#FFCE56",
                "#8A2BE2",
                "#7FFF00",
                "#FF7F50",
                "#6495ED",
                "#DC143C",
                "#00FFFF",
                "#FF4500",
                "#9400D3",
                "#008080"
            ]
        }]
    };

    var myDoughnutChart = new Chart(ctx, {
        type: 'doughnut',
        data: data
    });
</script>


</main>
{% endblock content %}