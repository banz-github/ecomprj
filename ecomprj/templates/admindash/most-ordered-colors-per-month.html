<!-- In your most-ordered-colors-per-month.html template -->
{% extends 'admindash/base-dash.html' %}
{% load static %}
{% block content %}       
    {% load humanize %}
    {% load custom_filters %}

    <main>
        <!-- Add any necessary styling or structure here -->

        <div class="analytics-section">
            <h2>Most Ordered Colors for {{ material_name }} - {{product_type}} by Month</h2>

            {% for month, colors in most_ordered_colors_by_month.items %}
                {% if colors %}
                <h1 style="color:#72bcd4">{{ month|date:"F Y" }}</h1>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Color Name</th>
                                    <th>Total Quantity</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for color_data in colors %}
                                    <tr>
                                        <td>{{ color_data.color__name }}</td>
                                        <td>{{ color_data.total_quantity }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Donut Chart Container -->
                    <div class="donut-chart-container">
                        <canvas id="colorDonutChart{{ forloop.counter }}"></canvas>
                    </div>
                    
                    <!-- Add JavaScript to create Donut Chart for Colors -->
                    <script>
                        var colorDonutData{{ forloop.counter }} = {
                            labels: [{% for color_data in colors %}"{{ color_data.color__name }}",{% endfor %}],
                            datasets: [{
                                data: [{% for color_data in colors %}{{ color_data.total_quantity }},{% endfor %}],
                                backgroundColor: [
                                    {% for color_data in colors %}
                                        '{{ color_data.color__name|random_neutral_color }}',
                                    {% endfor %}
                                ],
                                hoverOffset: 4
                            }]
                        };

                        var colorDonutChart{{ forloop.counter }} = new Chart(document.getElementById('colorDonutChart{{ forloop.counter }}'), {
                            type: 'doughnut',
                            data: colorDonutData{{ forloop.counter }},
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'top',
                                    },
                                    title: {
                                        display: false,
                                        text: 'Most Ordered Colors'
                                    }
                                }
                            }
                        });
                    </script>
                {% endif %}
                <!-- Add any additional visualization or charts if needed -->
            {% endfor %}
        </div>

        <!-- ... (existing code) -->
    </main>
{% endblock content %}
