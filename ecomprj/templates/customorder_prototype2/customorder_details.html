{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Order Summary</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        .container {
            margin-top: 50px;
        }

        .card {
            margin-bottom: 20px;
        }

        .card-header {
            background-color: #f8f9fa;
            border-bottom: none;
            color: #333;
        }

        .color-image {
            width: 125%;
            height: auto;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .color-image:hover {
            transform: scale(1.1);
 
        }

        .submit-btn {
            background-color: #4caf50;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                </div>
                <div class="card-body">
                    <p><strong>Product Type:</strong> {{ product_type }}</p>
                    <p><strong>Foam:</strong> {{ foam_types }} | ₱{{ foam_percubicft_price_display}} per Cubic Feet</p>
                    <p><strong>Material:</strong> {{ material_name }} | ₱{{fabric_peryard_price_display}} per Yard</p>
                    <p><strong>Color:</strong> {{ color_name }}</p>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Order Additional Form</h5>
                </div>
                <div class="card-body">
                    <form method="post" action="{% url 'submit_order' product_type=product_type foam_types=foam_types material_name=material_name color_name=color_name %}" onsubmit="return validateForm()" enctype="multipart/form-data">
                        {% csrf_token %}

                        {% comment %}  {% endcomment %}
                        {% comment %} <div class="form-group">
                            <label for="size">Size:</label>
                            <select class="form-control" name="size">
                                {% if product_type %}
                                    {% for s in size %}
                                        <option value="{{ s.size_title }}">{{ s.size_title }}</option>
                                    {% endfor %}
                                {% else %}
                                    <option>No sizes available</option>
                                {% endif %}
                            </select>
                        </div> {% endcomment %}
                        
                        
                        {% comment %}  {% endcomment %}
{% comment %}                         
                        <div class="form-group">
                            <label for="quantity">Quantity:</label>
                            <input type="number" class="form-control" name="quantity" min="1" max="4" value="1" required>
                        </div> {% endcomment %}
                        <!-- HTML template -->

                        {% comment %} <div class="form-group">
                            <label for="size">Size:</label>
                            <select class="form-control" name="size" id="size">
                                {% if product_type %}
                                    {% for s in size %}
                                        <option value={{s.foam_amount_v2}}>{{ s.size_title }}</option>
                                    {% endfor %}
                                {% else %}
                                    <option>No sizes available</option>
                                {% endif %}
                            </select>
                        </div> {% endcomment %}

                        <!--NEWWWW-->

                        <select class="form-control" name="size" id="size">
                            {% if product_type %}
                                {% for s in size %}
                                    <option value="{{ s.foam_amount_v2 }}" data-foam-amount="{{ s.foam_amount_v2 }}" data-fabric-amount="{{ s.fabric_yard_v2 }}">{{ s.size_title }}</option>
                                {% endfor %}
                            {% else %}
                                <option>No sizes available</option>
                            {% endif %}
                        </select>
                        
                        <div class="form-group">
                            <label for="quantity">Quantity:</label>
                            <input type="number" class="form-control" name="quantity" id="quantity" min="1" max="4" value="1" required>
                        </div>
                        
                        <!-- Display the selected Size and Quantity -->
                        <div>
                            Selected Size's Foam Amount: <span id="selectedSize">None</span><br>
                            Selected Size's Fabric Amount: <span id="selectedFabric">None</span><br>
                            Selected Quantity: <span id="selectedQuantity">None</span>

                            Calculation Dummy: <span id="resultDisplay">None</span>
                        </div>
                        
                        

                        <div class="form-group">
                            <label for="customer_notes">Customer Notes:</label>
                            <textarea class="form-control" name="customer_notes" rows="4" cols="50"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="purpose">Purpose:</label>
                            <select class="form-control" name="purpose">
                                {% for purpose_option_key, purpose_option_display in ORDER_PURPOSE %}
                                    <option value="{{ purpose_option_key }}">{{ purpose_option_display }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Make or Repair:</label><br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="make_or_repair" id="make" value="make" checked>
                                <label class="form-check-label" for="make">Make</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="make_or_repair" id="repair" value="repair">
                                <label class="form-check-label" for="repair">Repair</label>
                            </div>
                        </div>

                        {% comment %} <div class="form-group">
                            <label for="receipt_img">Receipt Image:</label>
                            <input type="file" class="form-control-file" name="receipt_img" accept="image/*">
                        </div> {% endcomment %}

                        <div class="form-group">
                            <p><strong>Ordered by:</strong> {{ request.user.profile }}</p>
                        </div>

                        <button type="submit" class="btn btn-primary">Submit Order</button>
                    </form>
                </div>
            </div>
        </div>



        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                </div>
                <div class="card-body">
                    <h1>Total Estimated Price:</h1>
                    <br>
                    <h1>Downpayment Requirement:</h1>
                </div>
            </div>
            

            <div class="card">
                <div class="card-header">
                </div>
                <div class="card-body">
                    {% if color.image %}
                        <img src="{{ color.image.url }}" class="color-image" alt="Color Image">
                    {% else %}
                        <p>No image available for this color.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS and dependencies -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


<!-- Client-side validation -->
<!-- Add this script at the end of your HTML body -->
<!-- JavaScript code -->

<!-- THIS ONE BELOW IS WORKING-->
{% comment %} <script>
    document.addEventListener('DOMContentLoaded', function () {
        const sizeSelect = document.getElementById('size');
        const quantityInput = document.getElementById('quantity');
        const selectedSizeSpan = document.getElementById('selectedSize');
        const selectedQuantitySpan = document.getElementById('selectedQuantity');

        sizeSelect.addEventListener('change', function () {
            selectedSizeSpan.textContent = sizeSelect.value;
        });

        quantityInput.addEventListener('input', function () {
            selectedQuantitySpan.textContent = quantityInput.value;
        });
    });
</script> {% endcomment %}
{% comment %} 
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sizeSelect = document.getElementById('size');
        const quantityInput = document.getElementById('quantity');
        const selectedSizeSpan = document.getElementById('selectedSize');
        const selectedQuantitySpan = document.getElementById('selectedQuantity');
        const selectedFabricSpan = document.getElementById('selectedFabric');

        sizeSelect.addEventListener('change', function () {
            const selectedOption = sizeSelect.options[sizeSelect.selectedIndex];
            const foamAmount = parseFloat(selectedOption.getAttribute('data-foam-amount'));
            const fabricAmount = parseFloat(selectedOption.getAttribute('data-fabric-amount'));

            selectedSizeSpan.textContent = foamAmount.toFixed(2); // Ensure it's displayed with two decimal places
            selectedFabricSpan.textContent = fabricAmount.toFixed(2); // Ensure it's displayed with two decimal places
        });

        quantityInput.addEventListener('input', function () {
            selectedQuantitySpan.textContent = quantityInput.value;
        });
    });
</script> {% endcomment %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sizeSelect = document.getElementById('size');
        const quantityInput = document.getElementById('quantity');
        const selectedSizeSpan = document.getElementById('selectedSize');
        const selectedQuantitySpan = document.getElementById('selectedQuantity');
        const selectedFabricSpan = document.getElementById('selectedFabric');
        const resultDisplaySpan = document.getElementById('resultDisplay');

        sizeSelect.addEventListener('change', function () {
            const selectedOption = sizeSelect.options[sizeSelect.selectedIndex];
            const foamAmount = parseFloat(selectedOption.getAttribute('data-foam-amount'));
            const fabricAmount = parseFloat(selectedOption.getAttribute('data-fabric-amount'));

            selectedSizeSpan.textContent = foamAmount.toFixed(2);
            selectedFabricSpan.textContent = fabricAmount.toFixed(2);

            calculateSum(foamAmount, fabricAmount);
        });

        quantityInput.addEventListener('input', function () {
            selectedQuantitySpan.textContent = quantityInput.value;
        });

        function calculateSum(foamAmount, fabricAmount) {
            const foamPerCubicFtPrice = parseFloat("{{ foam_percubicft_price_display }}");
            const fabricPerYardPrice = parseFloat("{{ fabric_peryard_price_display }}");

            const sum = foamPerCubicFtPrice + fabricPerYardPrice + foamAmount + fabricAmount;
            resultDisplaySpan.textContent = sum.toFixed(2);
        }
    });
</script>


<script>
    


    function validateForm() {
        var quantity = document.getElementById("quantity").value;
        var customerNotes = document.getElementById("customer_notes").value;

        if (quantity === "" || customerNotes === "") {
            alert("Please complete all the fields.");
            return false;
        }
        return true;
    }
</script>

</body>
</html>
